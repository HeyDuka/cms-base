jQuery(document).ready(function() {
	var page_tree = null;
	Widget.createWithElement('tree', function(event, widget) {
		AdminInterface.sidebar.append(widget._element);
	}, function(widget) {
		widget.settings.description_from_item = function(item) {
			return item.Name;
		};
		widget.settings.has_children = function(item) {
			return item.TreeRight-item.TreeLeft > 1;
		};
		widget.settings.data_from_element = function(item) {
			return item.data('tree-data').Id;
		};
	}, '{{writeRequestValue=tree_session}}');
	AdminInterface.info_bar.getWidget().add_button('add-new-item', function() {
		Widget.create('page_detail', function(widget) {
			widget.open();
			widget.save_callback = function() {
				jQuery('.ui-tree.ui-list').each(function() {
					jQuery(this).getWidget().reload();
				});
			};
		});
	}, 'n', false);
});


