jQuery(document).ready(function() {
	//Init main content
	var string_list = AdminInterface.content.find('.string_list').getWidget();
	//Init info bar
	var info_bar = AdminInterface.info_bar.getWidget();
	info_bar.add_button('add-new-item', function() {
		Widget.create('string_detail', function(widget) {
			widget.open();
			widget.save_callback = function(result, error) {
				jQuery('.string_list.ui-list').each(function() {
					jQuery(this).getWidget().reload();
				});
			};
		});
	}, 'n', true).add_search_input("{{writeString=search.strings}}", function(search) {
		if(string_list.setSearch(search)) {
			string_list.reload();
		}
	});
	//Init sidebar
	var sidebar = AdminInterface.sidebar.find('.ui-list').getWidget();
	sidebar.settings.row_click_active_mode = 'toggle';
	sidebar.handle('list.row-click', function(event, row, element) {
		var name_space = element.data('name_space');
		if(!element.hasClass('ui-state-active')) {
		 	name_space = null;
		}
		string_list.setOption('name_space', name_space);
		string_list.reload();
	});
	
	// add row_count_info
	info_bar.add_row_count_info_for_list(string_list);

	//Init language change
	Widget.handle('cmos.language_changed', function() {
		string_list.reload();
	});
});