jQuery(document).ready(function() {
	var document_type_list = AdminInterface.content.find('.document_type_list').getWidget();
	var info_bar = AdminInterface.info_bar.getWidget();
	AdminInterface.info_bar.getWidget().add_button('add-new-item', function() {
		Widget.create('document_type_detail', function(widget) {
			widget.open();
			widget.save_callback = function() {
				jQuery('.document_type_list.ui-list').each(function() {
					jQuery(this).getWidget().reload();
				});
			};
		});
	}, 'n', true);
	var row_count_info = info_bar.get_row_count_info();
	info_bar.add_element(row_count_info, true);
	var list_reload_handler = function() {
		row_count_info.text("{{writeParameterizedString=list_count;total=$\{total\};current=$\{current\}}}".replace(/\$\{total\}/, this.getNumberOfRows()).replace('${current}', this.current_row_count()));
	};
	list_reload_handler.call(document_type_list);
	document_type_list.handle('list.reloaded', list_reload_handler);
		
	var sidebar = AdminInterface.sidebar.find('.ui-list').getWidget();
	sidebar.settings.row_click_active_mode = 'toggle';
	sidebar.handle('list.row-click', function(event, row, element) {
		var document_kind = element.data('document_kind');
		if(!element.hasClass('ui-state-active')) {
		 	document_kind = null;
		}
		document_type_list.setOption('document_kind', document_kind);
		document_type_list.reload();
	});

});